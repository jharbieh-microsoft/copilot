import { combine } from "@pnp/core";
import { body, InjectHeaders } from "@pnp/queryable";
import { graphPost, graphPut } from "../operations.js";
import { DriveItem } from "./types.js";
export function checkIn(checkInOptions) {
    return graphPost(DriveItem(this, "checkin"), body(checkInOptions));
}
export function checkOut() {
    return graphPost(DriveItem(this, "checkout"));
}
export async function driveItemUpload(fileOptions) {
    let path = "/content";
    if (fileOptions.filePathName) {
        path = `:/${fileOptions.filePathName}:/content`;
    }
    const q = DriveItem(this, null);
    // This assumes that `this` url doesn't have a trailing '/' which is should not, we'll revisit this if people are reporting issues.
    q.concat(path);
    if (fileOptions.contentType) {
        q.using(InjectHeaders({
            "Content-Type": fileOptions.contentType,
        }));
    }
    const data = await graphPut(q, { body: fileOptions.content });
    return {
        data,
        driveItem: DriveItem([this, `${combine("drives", data.parentReference.driveId, "items", data.id)}`]),
    };
}
//# sourceMappingURL=funcs.js.map